{% extends 'base.html' %}

{% block body %}

<!-- CARD DO PERFIL -->
<div class="container mt-5 d-flex justify-content-center">
  <div class="card p-3 w-100" style="max-width: 700px;">
    <div class="row align-items-center">

      <!-- FOTO -->
      <div class="col-12 col-md-4 text-center mb-3 mb-md-0">
        <img src="{{ current_user.foto_perfil_url }}" class="rounded img-fluid" alt="Foto de {{ current_user.username }}">
      </div>

      <!-- DADOS -->
      <div class="col-12 col-md-8">
        <h4 class="mb-0">{{ current_user.username }}</h4>
        <span>{{ current_user.email }}</span>

        <!-- STATS -->
        <div class="col-12 col-md-4 p-2 mt-3 bg-primary d-flex justify-content-around rounded text-white stats">
          <div class="d-flex flex-column text-center">
            <span class="articles">Cursos</span>
            {% if "Não informado" in current_user.cursos or current_user.cursos == "" %}
              <span class="number1">0</span>
            {% else %}
              <span class="number1">{{ current_user.cursos.count(";") + 1 }}</span>
            {% endif %}
          </div>
          <div class="d-flex flex-column text-center">
            <span class="rating">Posts</span>
            <span class="number3">{{ current_user.contar_posts() }}</span>
          </div>
        </div>

        <!-- BOTÃO EDITAR PERFIL -->
        <div class="col-12 col-md-4 mt-3">
          <a href="{{ url_for('editar_perfil') }}" class="w-100">
            <button class="btn btn-sm btn-outline-primary w-100">Editar Perfil</button>
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- CURSOS -->
<div class="container mt-4">
  <div class="w-100" style="max-width: 700px; margin: 0 auto; text-align: center;">
    <h4><strong>Cursos</strong></h4>
    <div class="mt-3">
      {% for curso in current_user.cursos.split(";") %}
        {% if curso == '' or curso == 'Não informado' %}
          <button type="button" class="btn btn-secondary mt-2" disabled>Nenhum curso</button>
        {% else %}
          <button type="button" class="btn btn-success mt-2" disabled>{{ curso }}</button>
        {% endif %}
      {% endfor %}
    </div>
  </div>
</div>

<!-- FORMULÁRIO EDITAR PERFIL -->
{% block form_editar_perfil %}
{% if form %}
<div class="container mt-4">
  <div class="w-100" style="max-width: 700px; margin: 0 auto;">
    <form method="POST" action="" id="form_editar_post" class="border p-4 pb-3 mt-2">
      {{ form.csrf_token }}
      <legend>Editar Perfil</legend>
      <fieldset>
        <div class="form-group">
          {{ form.titulo.label(class="form-control-label") }}
          {% if form.titulo.errors %}
            {{ form.titulo(class="form-control is-invalid") }}
            <div class="invalid-feedback">
              {% for erro in form.titulo.errors %}
                {{ erro }}
              {% endfor %}
            </div>
          {% else %}
            {{ form.titulo(class="form-control") }}
          {% endif %}
        </div>

        <div class="form-group">
          {{ form.corpo.label(class="form-control-label") }}
          {% if form.corpo.errors %}
            {{ form.corpo(class="form-control is-invalid") }}
            <div class="invalid-feedback">
              {% for erro in form.corpo.errors %}
                {{ erro }}
              {% endfor %}
            </div>
          {% else %}
            {{ form.corpo(class="form-control") }}
          {% endif %}
        </div>
      </fieldset>

      {{ form.botao_criar_post(class="btn btn-primary mt-2 mb-2") }}
    </form>
  </div>
</div>
{% endif %}
{% endblock %}

{% endblock %}
